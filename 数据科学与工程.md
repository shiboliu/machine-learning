[TOC]



# Data management in cloud environments: NoSQL and NewSQL data stores_2013

云环境中的数据管理：NoSQL和NewSQL数据存储

## Abstract

随着数据的激增，传统数据库在满足大数据的性能和规模要求方面不适用。于是本文讲述了NoSQL和NewSQL数据存储在处理大量数据的解决方案。

## Introduction

由于云计算的特性比较好，许多大数据程序部署在云环境中。云环境对数据管理提出了新要求：可扩展性、弹性、能够在不同服务器上运行、容错性、安全和隐私、可用性。

本文简要概述了NoSQL的概念和数据模型，讨论了NewSQL（*NewSQL解决方案旨在将关系数据模型引入NoSQL的世界*）数据存储，比较了各种NoSQL和NewSQL的决解方案。

## Background and related work

介绍相对于NoSQL领域的其它调查的相关概念和立场

### Cloud computing

云计算是一种实现无处不在、方便、按需网络访问可配置计算资源共享池的模型，该共享池可以以最小的管理工作量或服务提供商交互来快速提供和释放。

### The CAP theorem

CAP定理是分布式系统领域中的一个基本原理，指在一个分布式系统中，无法同时满足：一致性（*consistency*）、可用性（*availability*）、分区容错性（*partition tolerance*）。CAP定理指出分布式系统最多只能同时满足其中两个特性。

### NoSQL and NewSQL

NoSQL是非关系型数据库，使用键值存储、文档存储、列存储、图形存储等数据模型。NoSQL数据库通常具有高可扩展性、高可用性、灵活的数据模型和半结构化的数据存储特点，适合于处理大规模、分散的数据。

NewSQL是新型关系型数据库，NewSQL数据存储的类别被用于对一组解决方案进行分类，这些解决方案旨在为关系模型带来NoSQL解决方案提供的横向可扩展性和容错性的好处。NewSQL数据库通常采用分布式架构，支持多种数据模型，同时具备ACID事务、复杂查询、高性能和高可扩展性等特点，适合于需要处理复杂数据和海量数据的应用场景。

### Related surveys

说了其它的调查

## Methodology

本次调查采用系统方法来选择解决方案，根据DB引擎排名、在出版物中的被提及的频率。

## Data models

属于NoSQL类别的数据存储族可以根据其数据模型进一步的细分如下：

![image-20231219193210982](D:\Program Files (x86)\Typora\pictures\image-20231219193210982.png)

### Key-value stores

键值存储有一个基于键值对的简单数据模型，类似于关键映射或字典。在存储分布式数据方面非常高效，但不适合需要关系或结构的场景，无法处理数据级查询和索引，只能通过key执行查询。

key用于唯一的标识value，用于存储和检索value在数据存储区中。

value对数据存储是不透明的，可以存储任意数据类型（*包括整形、字符串、数组和对象*），提供无模式的数据类型。

in-memory key-value stores保存数据在内存中，如Memcached、Redis

persistent key-value stores保存数据在磁盘中，如BerkeleyDB、Voldemort、Riak

### Column-family stores

数据以面向列的方式存储，在Bigtable中，数据集由几行组成，每一行都由一个唯一的行关键字（*也称为主键*）寻址。每一行都由一组列族组成，不同的行可以有不同的列族。

类似于key-value，类似多级的key-value，行-列族，列族-列，name-value

相对于key-value存储提供更强大的索引和查询

### Document stores

提供了key-value存储数据模型的一个分支，使用key在数据存储中定位文档。适用于输入数据可以以文档格式表示的应用程序，文档存储只能存储可以表示为文档的数据。与key-value存储一样，在设置跨文档操作的多个关键事务中效率低下。

可以使用JSON或类似JSON的文件表示文档，如CouchDB和Couchbase使用JSON，MongoDB使用BSON（*二进制JSON*）

一个文档可以包含复杂的数据结构，并且不需要遵守固定的模式，每个文档可以具有不同的结构。

### Graph databases

使用图作为数据模型，可以有效地存储不同数据节点之间的关系。可以处理高度互连的数据，在遍历不同实体间的关系方面非常有效。在处理图形和关系以外的场景中，不如其它NoSQL数据存储高效，现有的图数据库在水平扩展时效率不高。

节点和边也具有key-value pair组成的单独属性

### NewSQL

NewSQL解决方案可能在内部使用不同的数据表示

## Querying

不同的数据模型提供不同的API和接口来进行查询。

key-value存储不可以基于value进行查询

Document存储提供了索引和查询文档内容的能力

NoSQL和NewSQL支持MapReduce，用于处理大型数据集的编程模型和相关实现

NoSQL也支持类SQL查询

NewSQL将SQL作为查询语言

NoSQL和NewSQL都支持命令行界面（*CLI*）

下面提供了最突出的NoSQL和NewSQL解决方案所提供的不同API支持以及所提供的其他查询功能的详细视图：

![image-20231219211021368](D:\Program Files (x86)\Typora\pictures\image-20231219211021368.png)

![image-20231219211433962](D:\Program Files (x86)\Typora\pictures\image-20231219211433962.png)

## Scaling

NoSQL和NewSQL能够通过向资源池中添加更多服务器来横向有效地扩展

关于正在缩放的内容，考虑了三个缩放维度：缩放读取请求、缩放写入请求、缩放数据存储

关于NoSQL和NewSQL数据存储的分区、复制、一致性和并发控制策略的比较如下：

![image-20231219211602314](D:\Program Files (x86)\Typora\pictures\image-20231219211602314.png)

![image-20231219211630111](D:\Program Files (x86)\Typora\pictures\image-20231219211630111.png)

### Partitioning

数据模型是定义存储分区策略的重要新宿

- 水平分区或分片
    大多数NoSQL和NewSQL数据存储都实现了某种水平分区或分片，将集合或行/记录存储到可能位于不同服务器上的不同段（或分片）中

    - 范围分区
        根据分区键的范围将数据分配给驻留在不同服务器中的分区，可以有效地处理范围查询，可能导致负载平衡问题，必须维护分区和节点的映射
        如：BerkeleyDB、Cassandra、HBase和MongoDB

    - 一致性哈希
        数据集被表示为圆或环，环被划分为多个范围，这些范围等于可用节点的数量，每个节点都映射到环上的一个点。可以很快地计算对象的位置，并且不需要映射服务，方便动态调整大小。会对范围查询差生负面影响
        如：Voldemort、Riak、Cassandra、DynamoDB、CouchDB、VoltDB和Clustrix

        ![image-20231220101603745](D:\Program Files (x86)\Typora\pictures\image-20231220101603745.png)

- 垂直分区
    将列集存储到不同的段中，并相应地进行分配



### Replication

复制可以提高读和写可扩展性、系统可靠性、容错性、耐用性。不同的复制模型会导致不同的数据存储扩展读写请求能力。

- 主从复制
    单个节点被指定为主节点，并且是唯一处理写请求的节点。更改从主节点传播到从属节点。具有主从复制的数据存储示例有Redis、BerkeleyDB和HBase。
    通常对扩展读取请求很有用，因为它允许许多从属服务器接受读取请求，例如BerkeleyDB和MongoDB。
- 多主复制
    多个节点可以处理写入请求，然后将这些请求传播到其余节点。如：CouchDB、CouchbaseServer
- 无主复制
    类似于多主复制，多个节点接受写入请求，所有节点在复制系统中扮演相同的角色，如Voldemort、Riak、Cassandra，这三个都是用哈希作为分区策略

![image-20231220100657409](D:\Program Files (x86)\Typora\pictures\image-20231220100657409.png)

### Consistency

涉及更新操作后如何在服务器节点之间查看数据

- 强一致性strong
    强一致性可确保在确认写入请求时，所有后续读取请求都可以看到相同（更新的）数据，同步复制通常可以确保很强的一致性，HBase是唯一一个专门支持强一致性的存储，除了NuoDB之外，所分析的NewSQL解决方案都是强一致的、完全事务性的数据存储。
- 最终一致性eventual
    最终一致性模型中，只要有足够的时间，更改最终会在系统中传播。某些服务器节点可能在一段时间内包含不一致（过时）的数据。如果没有其他一致性保证机制，异步复制将导致最终的一致性，因为写入确认和传播之间存在滞后。

### Concurrency control

所有解决方案都通过实现分区和复制来促进并发控制

并发控制可视为在单个服务器节点上同时访问同一实体、行或记录的一种方式

主要的并发控制方案可以分为悲观锁和乐观锁两类

- 悲观并发控制或悲观锁定假设两个或多个并发用户将尝试同时更新同一记录或对象。为了防止这种情况，在被访问的实体上加上一个锁，从而保证对单个操作的独占访问，试图访问相同数据的其他客户端必须等到第一个客户端完成其工作，可能导致性能下降
- 乐观并发控制或乐观锁定假设冲突是可能的，但很少发生。因此，数据存储不是锁定记录，而是在操作结束时进行检查，以确定并发用户是否试图修改同一记录。如果发现冲突，可以使用不同的冲突解决策略

## Security

安全性是很多NoSQL实现忽略的方面

本节将调查的数据存储与身份检查、授权、加密、审计功能进行了比较

调查的解决方法中发现的安全功能摘要如下：

![image-20231219234535180](D:\Program Files (x86)\Typora\pictures\image-20231219234535180.png)

NoSQL解决方案的安全特性不如传统RDBMS中包含的安全特性成熟

## Use cases

### Key-value stores

适用于应用程序使用唯一值作为key访问一组数据的场景，也适用于对象缓存，尤其是在内存中实现

Sadalage和Fowler使用了三个示例：存储Web会话信息、用户配置文件和配置、购物车数据

局限性：高度互联的数据、操作多个项目的操作

### Document stores

1. 处理可以轻松解释为文档的数据的应用程序，如博客平台、内容管理系统（CMS）
2. 存储可能具有不同结构的类似性质的项，如记录事件、监视来自企业系统的消息
3. 存储传感器网络数据

局限性：缺乏对文档之间的关系和涉及多个文档的实务操作的内置支持

### Column-family stores

- 包含列族概念的数据存储，SimpleDB和DynamoDB

    表现类似于Document存储，但是不允许嵌套对象 ，特别适用于用户希望避免管理数据存储的成本和复杂性的场景

- 不包含列祖概念的数据存储，HBase和Cassandra

    Cassandra可以处理大量写请求而优化的数据存储，可在繁重的工作负载下实现高度的更新吞吐量，可以作为集群中节点数量的函数性扩展

    不太适合查询高度动态的场景

局限性：缺乏对涉及多行的关系和事务操作的内置支持

### Graph databases

适用于基于位置的服务、推荐引擎、复杂的基于网络的应用程序，包括社交、信息、技术和生物网络

也可用于分布式应用程序中的内存泄漏检测

### NewSQL

适用于使用传统DBMS但具有额外可扩展性和性能要求的场景，适用于需要使用操作多个对象的事物和具有很强一致性要求的应用程序，如金融市场中的应用程序

## Opportunities

未来方向：需要建立一些标准术语，如需要标准化的校级基准、建立基准测试标准、需要完善的安全和隐私规定、需要研究在单个应用程序中使用多个NoSQL数据存储、需要更好的说明文档和社区

## Conclusions

近年来，云计算已成为一种计算范式，可用于满足当今应用程序不断增长的存储和处理需求。这项研究的重点是云计算系统的存储方面，特别是NoSQL和NewSQL数据存储。这些解决方案已成为传统关系数据库的替代方案，能够通过利用云环境处理大量数据。具体而言，本文回顾了NoSQL和NewSQL数据存储，目的是提供该领域的观点，为从业者和研究人员选择适当的存储解决方案提供指导，并确定该领域的挑战和机遇。在多个维度上对最突出的解决方案进行了比较，包括数据模型、查询功能、扩展和安全属性。讨论了使用NoSQL和NewSQL数据存储的用例和场景，并检查了各种解决方案对不同应用程序集的适用性。用例的讨论以及数据存储的比较将有助于从业者根据自己的需求选择最佳的存储解决方案。此外，这项工作还发现了该领域的挑战，包括术语多样性和不一致性、文档有限、比较和基准测试标准稀疏、解决方案偶尔不成熟和缺乏支持，以及不存在标准查询语言。

































